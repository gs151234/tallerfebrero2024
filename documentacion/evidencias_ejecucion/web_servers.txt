[sysadmin@bastion tallerfebrero2024]$ ansible-playbook -v -i inventories/hosts web_servers.yml 
Using /etc/ansible/ansible.cfg as config file

PLAY [Instalar OpenJDK y Tomcat 8 en Rocky Linux] *********************************************************************

TASK [Gathering Facts] ************************************************************************************************
ok: [serverA]

TASK [Instalar OpenJDK] ***********************************************************************************************
changed: [serverA] => {"changed": true, "msg": "", "rc": 0, "results": ["Installed: libXtst-1.2.3-7.el8.x86_64", "Installed: at-spi2-atk-2.26.2-1.el8.x86_64", "Installed: dconf-0.28.0-4.el8.x86_64", "Installed: pango-1.42.4-8.el8.x86_64", "Installed: at-spi2-core-2.28.0-1.el8.x86_64", "Installed: atk-2.28.1-1.el8.x86_64", "Installed: ttmkfdir-3.0.9-54.el8.x86_64", "Installed: tzdata-java-2024a-1.el8.noarch", "Installed: avahi-libs-0.7-21.el8_9.1.x86_64", "Installed: libdatrie-0.2.9-7.el8.x86_64", "Installed: pixman-0.38.4-3.el8_9.x86_64", "Installed: rest-0.8.1-2.el8.x86_64", "Installed: jasper-libs-2.0.14-5.el8.x86_64", "Installed: libepoxy-1.5.8-1.el8.x86_64", "Installed: libgusb-0.3.0-1.el8.x86_64", "Installed: graphite2-1.3.10-10.el8.x86_64", "Installed: java-11-openjdk-1:11.0.22.0.7-2.el8.x86_64", "Installed: java-11-openjdk-devel-1:11.0.22.0.7-2.el8.x86_64", "Installed: java-11-openjdk-headless-1:11.0.22.0.7-2.el8.x86_64", "Installed: libfontenc-1.1.3-8.el8.x86_64", "Installed: cups-libs-1:2.2.6-54.el8_9.x86_64", "Installed: gtk-update-icon-cache-3.22.30-11.el8.x86_64", "Installed: libthai-0.1.27-2.el8.x86_64", "Installed: libtiff-4.0.9-29.el8_8.x86_64", "Installed: gtk3-3.22.30-11.el8.x86_64", "Installed: libmodman-2.0.1-17.el8.x86_64", "Installed: dejavu-fonts-common-2.35-7.el8.noarch", "Installed: javapackages-filesystem-5.3.0-2.module+el8.3.0+125+5da1ae29.noarch", "Installed: dejavu-sans-mono-fonts-2.35-7.el8.noarch", "Installed: pkgconf-1.4.2-1.el8.x86_64", "Installed: pkgconf-m4-1.4.2-1.el8.noarch", "Installed: jbigkit-libs-2.1-14.el8.x86_64", "Installed: pkgconf-pkg-config-1.4.2-1.el8.x86_64", "Installed: harfbuzz-1.7.5-3.el8.x86_64", "Installed: libpkgconf-1.4.2-1.el8.x86_64", "Installed: xkeyboard-config-2.28-1.el8.noarch", "Installed: libproxy-0.4.15-5.2.el8.x86_64", "Installed: hicolor-icon-theme-0.17-2.el8.noarch", "Installed: gdk-pixbuf2-modules-2.36.12-5.el8.x86_64", "Installed: libjpeg-turbo-1.5.3-12.el8.x86_64", "Installed: libwayland-client-1.21.0-1.el8.x86_64", "Installed: libwayland-cursor-1.21.0-1.el8.x86_64", "Installed: fontconfig-2.13.1-4.el8.x86_64", "Installed: libwayland-egl-1.21.0-1.el8.x86_64", "Installed: fontpackages-filesystem-1.44-22.el8.noarch", "Installed: xorg-x11-font-utils-1:7.5-41.el8.x86_64", "Installed: cairo-1.15.12-6.el8.x86_64", "Installed: cairo-gobject-1.15.12-6.el8.x86_64", "Installed: xorg-x11-fonts-Type1-7.5-19.el8.noarch", "Installed: gsettings-desktop-schemas-3.32.0-6.el8.x86_64", "Installed: libxcb-1.13.1-1.el8.x86_64", "Installed: libxkbcommon-0.9.1-1.el8.x86_64", "Installed: libsoup-2.62.3-4.el8.x86_64", "Installed: gdk-pixbuf2-2.36.12-5.el8.x86_64", "Installed: glib-networking-2.56.1-1.1.el8.x86_64", "Installed: nspr-4.35.0-1.el8_8.x86_64", "Installed: nss-3.90.0-6.el8_9.x86_64", "Installed: abattis-cantarell-fonts-0.0.25-6.el8.noarch", "Installed: nss-softokn-3.90.0-6.el8_9.x86_64", "Installed: lcms2-2.9-2.el8.x86_64", "Installed: nss-softokn-freebl-3.90.0-6.el8_9.x86_64", "Installed: json-glib-1.4.4-1.el8.x86_64", "Installed: colord-libs-1.4.2-1.el8.x86_64", "Installed: nss-sysinit-3.90.0-6.el8_9.x86_64", "Installed: adwaita-cursor-theme-3.28.0-3.el8.noarch", "Installed: libX11-1.6.8-6.el8.x86_64", "Installed: libX11-common-1.6.8-6.el8.noarch", "Installed: adwaita-icon-theme-3.28.0-3.el8.noarch", "Installed: nss-util-3.90.0-6.el8_9.x86_64", "Installed: alsa-lib-1.2.9-1.el8.x86_64", "Installed: libXau-1.0.9-3.el8.x86_64", "Installed: libXcomposite-0.4.4-14.el8.x86_64", "Installed: libXcursor-1.1.15-3.el8.x86_64", "Installed: lua-5.3.4-12.el8.x86_64", "Installed: libXdamage-1.1.4-14.el8.x86_64", "Installed: lksctp-tools-1.0.18-3.el8.x86_64", "Installed: libXext-1.3.4-1.el8.x86_64", "Installed: copy-jdk-configs-4.0-2.el8.noarch", "Installed: libXfixes-5.0.3-7.el8.x86_64", "Installed: fribidi-1.0.4-9.el8.x86_64", "Installed: libXft-2.3.3-1.el8.x86_64", "Installed: libXi-1.7.10-1.el8.x86_64", "Installed: libXinerama-1.1.4-1.el8.x86_64", "Installed: libXrandr-1.5.2-1.el8.x86_64", "Installed: libXrender-0.9.10-7.el8.x86_64"]}

TASK [Descargar Tomcat 8] *********************************************************************************************
changed: [serverA] => {"changed": true, "checksum_dest": null, "checksum_src": "bc75774208596d351c3c9fa7a44076bff5b41735", "dest": "/tmp/apache-tomcat-8.5.73.tar.gz", "elapsed": 83, "gid": 0, "group": "root", "md5sum": "22b2d1adb50692403ae2a4ce0fe11700", "mode": "0644", "msg": "OK (10581990 bytes)", "owner": "root", "secontext": "unconfined_u:object_r:user_home_t:s0", "size": 10581990, "src": "/home/ansible/.ansible/tmp/ansible-tmp-1709053872.7423806-6506-51946875421790/tmplzkkr2fm", "state": "file", "status_code": 200, "uid": 0, "url": "https://archive.apache.org/dist/tomcat/tomcat-8/v8.5.73/bin/apache-tomcat-8.5.73.tar.gz"}

TASK [Instalar tar y wget] ********************************************************************************************
changed: [serverA] => (item=tar) => {"ansible_loop_var": "item", "changed": true, "item": "tar", "msg": "", "rc": 0, "results": ["Installed: tar-2:1.30-9.el8.x86_64"]}
changed: [serverA] => (item=wget) => {"ansible_loop_var": "item", "changed": true, "item": "wget", "msg": "", "rc": 0, "results": ["Installed: wget-1.19.5-11.el8.x86_64", "Installed: libmetalink-0.1.3-7.el8.x86_64"]}

TASK [Descomprimir Tomcat] ********************************************************************************************
changed: [serverA] => {"changed": true, "dest": "/opt/", "extract_results": {"cmd": ["/bin/gtar", "--extract", "-C", "/opt", "-z", "-f", "/tmp/apache-tomcat-8.5.73.tar.gz"], "err": "", "out": "", "rc": 0}, "gid": 0, "group": "root", "handler": "TgzArchive", "mode": "0755", "owner": "root", "secontext": "system_u:object_r:usr_t:s0", "size": 34, "src": "/tmp/apache-tomcat-8.5.73.tar.gz", "state": "directory", "uid": 0}

TASK [Crear grupo apache] *********************************************************************************************
changed: [serverA] => {"changed": true, "gid": 1002, "name": "apache", "state": "present", "system": false}

TASK [Crear usuario apache] *******************************************************************************************
changed: [serverA] => {"changed": true, "comment": "", "create_home": true, "group": 100, "groups": "apache", "home": "/opt/apache-tomcat-8.5.73", "name": "apache", "shell": "/bin/nologin", "state": "present", "stderr": "useradd: warning: the home directory already exists.\nNot copying any file from skel directory into it.\n", "stderr_lines": ["useradd: warning: the home directory already exists.", "Not copying any file from skel directory into it."], "system": false, "uid": 1002}

TASK [Establecer permisos] ********************************************************************************************
changed: [serverA] => {"changed": true, "gid": 1002, "group": "apache", "mode": "0755", "owner": "apache", "path": "/opt/apache-tomcat-8.5.73", "secontext": "unconfined_u:object_r:usr_t:s0", "size": 4096, "state": "directory", "uid": 1002}

TASK [Iniciar Tomcat] *************************************************************************************************
changed: [serverA] => {"ansible_job_id": "j585959256279.9353", "changed": true, "finished": 0, "results_file": "/home/ansible/.ansible_async/j585959256279.9353", "started": 1}

TASK [Habilitar puerto 8080/tcp] **************************************************************************************
changed: [serverA] => {"changed": true, "msg": "Permanent and Non-Permanent(immediate) operation, Changed port 8080/tcp to enabled"}

TASK [Copiar archivo tomcat.service al Tomcat] ************************************************************************
changed: [serverA] => {"changed": true, "checksum": "bf1a80ad302fb7a8c6c86053d61e172e693749cd", "dest": "/etc/systemd/system/tomcat.service", "gid": 0, "group": "root", "md5sum": "a8af6349e5bbebf55b3c7c32406c6246", "mode": "0644", "owner": "root", "secontext": "system_u:object_r:tomcat_unit_file_t:s0", "size": 265, "src": "/home/ansible/.ansible/tmp/ansible-tmp-1709053975.0241919-6628-130295167987316/source", "state": "file", "uid": 0}

TASK [Iniciar servicio tomcat] ****************************************************************************************
changed: [serverA] => {"changed": true, "enabled": true, "name": "tomcat", "state": "started", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket network.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Apache Tomcat", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecStart": "{ path=/opt/apache-tomcat-8.5.73/bin/startup.sh ; argv[]=/opt/apache-tomcat-8.5.73/bin/startup.sh ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/opt/apache-tomcat-8.5.73/bin/shutdown.sh ; argv[]=/opt/apache-tomcat-8.5.73/bin/shutdown.sh ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/etc/systemd/system/tomcat.service", "FreezerState": "running", "GID": "[not set]", "Group": "apache", "GuessMainPID": "yes", "IOAccounting": "no", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IPAccounting": "no", "IPEgressBytes": "18446744073709551615", "IPEgressPackets": "18446744073709551615", "IPIngressBytes": "18446744073709551615", "IPIngressPackets": "18446744073709551615", "Id": "tomcat.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "262144", "LimitNOFILESoft": "1024", "LimitNPROC": "6920", "LimitNPROCSoft": "6920", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "6920", "LimitSIGPENDINGSoft": "6920", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "MemoryAccounting": "yes", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "tomcat.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "11072", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "disabled", "UnitFileState": "disabled", "User": "apache", "UtmpMode": "init", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

PLAY RECAP ************************************************************************************************************
serverA                    : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 
